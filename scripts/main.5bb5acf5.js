"use strict";function ReducetarianCalculator(){this.views={},this.userInput={},this.userInput.meatyMealsPerDay=null,this.userInput.firstResponseToMeatyMealsPerDay=null,this.userInput.strategy="meatless_mondays",this.calculations={},this.calculations.meatyMealsPerWeek=null,this.calculations.gallonsSaved=null,this.calculations.animalsSaved=null,this.calculations.co2Saved=null,this.state={},this.state.pledgeTaken=!1,this.facts={},this.facts.globalAverageDailyConsumption=.1,this.facts.portionSizes=[],this.facts.portionSizes[1]={lbs:.23,globalPercentile:82},this.facts.portionSizes[2]={lbs:.34,globalPercentile:96},this.facts.portionSizes[3]={lbs:.45,globalPercentile:99.5},this.charts={},this.charts.barChart=null,this.charts.donutChart=null,this.colors={},this.colors.brandPrimary="#89b100",this.colors.brandPrimaryHighlight="#a9c83a",this.colors.gray="#555",this.colors.grayHighlight="#777"}function getRandomInt(a,b){return Math.floor(Math.random()*(b-a))+a}riot.route("/ra",function(){console.log("hmmmmmaaaa")}),Chart.types.Bar.extend({name:"BarAlt",draw:function(){Chart.types.Bar.prototype.draw.apply(this,arguments);var a=this.chart.ctx;a.save(),a.textAlign="center",a.textBaseline="bottom",a.fillStyle=this.options.scaleFontColor;var b=.4*this.scale.xScalePaddingLeft,c=this.chart.height/2;a.translate(b,c),a.rotate(-90*Math.PI/180),a.fillText(this.datasets[0].label,0,0),a.restore()}}),ReducetarianCalculator.prototype.updateCharts=function(){this.updateBarChart(),this.updateDonutChart()},ReducetarianCalculator.prototype.updateBarChart=function(){if(null!==this.charts.barChart)this.charts.barChart.datasets[0].bars[1].value=this.facts.portionSizes[this.userInput.meatyMealsPerDay].lbs,this.charts.barChart.update();else{var a={labels:["Global average","You"],datasets:[{label:"Lbs of meat consumption",fillColor:this.colors.gray,strokeColor:this.colors.gray,highlightFill:this.colors.grayHighlight,highlightStroke:this.colors.grayHighlight,data:[this.facts.globalAverageDailyConsumption,this.facts.portionSizes[this.userInput.meatyMealsPerDay].lbs]}]},b=document.getElementById("barChart").getContext("2d"),c={scaleShowHorizontalLines:!1,scaleShowVerticalLines:!1,scaleOverride:!0,scaleSteps:5,scaleStepWidth:.1,scaleStartValue:0,scaleFontSize:14,scaleGridLineColor:"rgba(26,26,26,.7)",scaleFontColor:"rgba(26,26,26,.7)",scaleFontFamily:"'proxima-nova', 'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",scaleFontStyle:"bold",scaleLabel:"          <%=value%>",tooltipFillColor:"rgba(0,0,0,0.8)",tooltipFontFamily:"'proxima-nova', 'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",tooltipTemplate:"<%if (label){%><%=label%>: <%}%><%= value %> lbs"};this.charts.barChart=new Chart(b).BarAlt(a,c),this.charts.barChart.datasets[0].bars[0].fillColor=this.colors.brandPrimary,this.charts.barChart.datasets[0].bars[0].strokeColor=this.colors.brandPrimary,this.charts.barChart.datasets[0].bars[0].highlightFill=this.colors.brandPrimaryHighlight,this.charts.barChart.datasets[0].bars[0].highlightStroke=this.colors.brandPrimaryHighlight,this.charts.barChart.update()}},ReducetarianCalculator.prototype.updateDonutChart=function(){if(null!==this.charts.donutChart)this.charts.donutChart.segments[0].value=this.facts.portionSizes[this.userInput.meatyMealsPerDay].globalPercentile,this.charts.donutChart.segments[1].value=100-this.facts.portionSizes[this.userInput.meatyMealsPerDay].globalPercentile,this.charts.donutChart.update();else{var a=[{value:this.facts.portionSizes[this.userInput.meatyMealsPerDay].globalPercentile,color:this.colors.brandPrimary,highlight:this.colors.brandPrimary,label:"eat less meat than you"},{value:100-this.facts.portionSizes[this.userInput.meatyMealsPerDay].globalPercentile,color:this.colors.gray,highlight:this.colors.grayHighlight,label:"eat more meat than you"}],b=document.getElementById("donutChart").getContext("2d"),c={tooltipFillColor:"rgba(0,0,0,0.8)",tooltipFontFamily:"'proxima-nova', 'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",tooltipTemplate:"<%if (label){%><%= value %>% <%=label%><%}%>"};this.charts.donutChart=new Chart(b).Doughnut(a,c),this.charts.donutChart.datasets[0].bars[0].fillColor=this.colors.brandPrimary,this.charts.donutChart.datasets[0].bars[0].strokeColor=this.colors.brandPrimary,this.charts.donutChart.datasets[0].bars[0].highlightFill=this.colors.brandPrimaryHighlight,this.charts.donutChart.datasets[0].bars[0].highlightStroke=this.colors.brandPrimaryHighlight,this.charts.donutChart.update()}},ReducetarianCalculator.prototype.setUserInput=function(a,b){"meatyMealsPerDay"===a&&null===this.userInput.meatyMealsPerDay&&this.setUserInput("firstResponseToMeatyMealsPerDay",b),this.userInput[a]=b},ReducetarianCalculator.prototype.calculateMeatyMealsPerWeek=function(){this.calculations.meatyMealsPerWeek=7*this.userInput.meatyMealsPerDay},ReducetarianCalculator.prototype.calculateGlobalConsumptionPercentile=function(){this.calculations.globalConsumptionPercentile=this.facts.portionSizes[this.userInput.meatyMealsPerDay].globalPercentile},ReducetarianCalculator.prototype.calculateFactorToAverageConsumption=function(){this.calculations.factorToAverageConsumption=this.facts.portionSizes[this.userInput.meatyMealsPerDay].lbs/this.facts.globalAverageDailyConsumption},ReducetarianCalculator.prototype.updateImpactCalculation=function(){ReducetarianCalculator.calculateAnimalsSaved(),ReducetarianCalculator.calculateCo2Saved(),ReducetarianCalculator.calculateWaterSaved()},ReducetarianCalculator.prototype.calculateWaterSaved=function(){this.calculations.waterSaved=getRandomInt(1,10)},ReducetarianCalculator.prototype.calculateAnimalsSaved=function(){this.calculations.animalsSaved=getRandomInt(10,30)},ReducetarianCalculator.prototype.calculateCo2Saved=function(){this.calculations.co2Saved=getRandomInt(1,10)},ReducetarianCalculator.prototype.pledge=function(){console.log("Submitting pledge"),ReducetarianCalculator.state.pledgeTaken=!0};var ReducetarianCalculator=new ReducetarianCalculator;ReducetarianCalculator.views.main=riot.mount("meat-consumption-calculator"),riot.route.start();