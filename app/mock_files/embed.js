(function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};this.MoonclerkEmbed=function(){function e(e){this.replaceFrame=t(this.replaceFrame,this);var o,r;for(o in e)r=e[o],this.options[o]=e[o];if(!window.postMessage)throw"This browser does not support postMessage.";this.addEvent(window,"message",this.bindMethod(this.resizeFrame,this))}var o,r,n,i,s;return e.prototype.options={checkoutToken:null,host:"app.moonclerk.com",ssl:!0,width:"100%",height:0,cid:null,track:[],scrollOffsetTop:0},r="",o=0,i="",n=0,s=null,e.prototype.display=function(){var t;return t=this.buildFrame(),this.options.track.indexOf("ga")>-1&&null!=window.ga?window.ga(this.loadFrame(t)):this.replaceFrame(t)},e.prototype.loadFrame=function(t){return function(e){return function(o){return window.linker=window.linker||new window.gaplugins.Linker(o),t.src=window.linker.decorate(t.src),e.replaceFrame(t)}}(this)},e.prototype.replaceFrame=function(t){var e;return e=document.getElementById("mc"+this.options.checkoutToken),e.innerHTML="",e.appendChild(t)},e.prototype.buildFrame=function(){var t;return t=document.createElement("iFrame"),t.setAttribute("id","frame-mc"+this.options.checkoutToken),t.setAttribute("src",this.frameUrl()),t.setAttribute("height",this.options.height),t.setAttribute("frameborder",0),t.setAttribute("scrolling","no"),t.setAttribute("style","width:"+this.widthStyle()+";border:none;"),t.setAttribute("allowtransparency","true"),t},e.prototype.widthStyle=function(){return isNaN(this.options.width)?this.options.width:this.options.width+"px"},e.prototype.frameUrl=function(){var t;return t=this.linkUrl()+"?embed=true",null!=this.options.cid?t+"&cid="+this.options.cid:t},e.prototype.linkUrl=function(){return this.baseUrl()+"/pay/"+this.options.checkoutToken},e.prototype.baseUrl=function(){return this.protocol()+this.options.host},e.prototype.protocol=function(){return this.options.ssl?"https://":"http://"},e.prototype.resizeFrame=function(t){var e,s;if(t.origin===this.baseUrl()&&(e=this.parseMessage(t.data),r="frame-mc"+e.checkoutHash,o=e.height,r!==i||o!==n)){if(s=document.getElementById(r.toString()),null===s)return;return s.style.height=o.toString()+"px",this.scrollIntoView(s,e.scrollTop),i=r,n=o}},e.prototype.scrollIntoView=function(t,e){var o,r,n,i,s;return null==e&&(e=!1),n=this.findTop(t)-this.options.scrollOffsetTop,o=n+t.offsetHeight,i=window.pageYOffset,r=o-250,e||i>r?(s=Math.abs(n-20),window.scrollTo(window.pageXOffset,s)):void 0},e.prototype.addEvent=function(t,e,o){return t.attachEvent?(t["e"+e+o]=o,t[e+o]=function(){return t["e"+e+o](window.event)},t.attachEvent("on"+e,t[e+o])):t.addEventListener(e,o,!1)},e.prototype.bindMethod=function(t,e){return function(){return t.apply(e,arguments)}},e.prototype.findTop=function(t){var e;for(e=0;t.offsetParent;)e+=t.offsetTop,t=t.offsetParent;return e},e.prototype.parseMessage=function(t){var e,o,r,n,i,s;for(r={},s=t.split("&"),e=0,o=s.length;o>e;e++)n=s[e],i=n.split("="),2===i.length&&(r[i[0]]=function(){switch(i[0]){case"scrollTop":return"true"===i[1];case"height":return parseInt(i[1]);default:return i[1]}}());return r},e}()}).call(this);